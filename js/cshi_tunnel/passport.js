$.fx.speeds._default = 0;
var CartPos = 0;
//Изменение размера экрана
//window.moveTo(0, 0); 
//window.resizeTo(screen.availWidth, screen.availHeight);

// Преобразует число в строку формата 1_separator000_separator000._decimal
function sdf_FTS(_number, _decimal, _separator)
// сокращение переводится как Float To String
// sd_ - понятно и так почему :)
// _number - число любое, целое или дробное не важно
// _decimal - число знаков после запятой
// _separator - разделитель разрядов
{
    // определяем, количество знаков после точки, по умолчанию выставляется 2 знака
    var decimal = (typeof (_decimal) != 'undefined') ? _decimal : 2;

    // определяем, какой будет сепаратор [он же разделитель] между разрядами
    var separator = (typeof (_separator) != 'undefined') ? _separator : '';

    // преобразовываем входящий параметр к дробному числу, на всяк случай, если вдруг
    // входящий параметр будет не корректным
    var r = parseFloat(_number)

    // так как в javascript нет функции для фиксации дробной части после точки
    // то выполняем своеобразный fix
    var exp10 = Math.pow(10, decimal);// приводим к правильному множителю
    r = Math.round(r * exp10) / exp10;// округляем до необходимого числа знаков после запятой

    // преобразуем к строгому, фиксированному формату, так как в случае вывода целого числа
    // нули отбрасываются не корректно, то есть целое число должно
    // отображаться 1.00, а не 1
    rr = Number(r).toFixed(decimal).toString().split('.');

    // разделяем разряды в больших числах, если это необходимо
    // то есть, 1000 превращаем 1 000
    b = rr[0].replace(/(\d{1,3}(?=(\d{3})+(?:\.\d|\b)))/g, "\$1" + separator);
    r = b + '.' + rr[1];

    if (r == 'NaN.undefined') r = '';
    return r;// возвращаем результат
}

//Код диалогового окна
function over(elem, backGrcolor) {
    elem.style.font.color = backGrcolor
    elem.style.color = 'red'
}

//------------------------------------------------------------------------------
function out(elem) {
    elem.style.font.color = ''
    elem.style.color = ''
}

//------------------------------------------------------------------------------
function SendCartNum(obj, type) {
    CartPos = obj.value
    $(document).ready(function () {

        switch (type) {
            case ('dry'):
                $('#dialog').dialog({
                    autoOpen: false,
                    show: 'blind',
                    hide: 'blind',
                    title: 'Вагон в сушиле на позиции ' + obj.value,
                    height: 500,
                    width: 650
                });
                break;
            case ('furn'):
                $('#dialog').dialog({
                    autoOpen: false,
                    show: 'blind',
                    hide: 'blind',
                    title: 'Вагон в печи на позиции ' + obj.value,
                    height: 500,
                    width: 650
                });
                break;
        }
    });
    $('#dialog').dialog('open');
    SendRequest_for_passport(obj, type);
//  $('#dialog').text('Вагон №' + obj.value);
}

//------------------------------------------------------------------------------
var request;
var type2;

function SendRequest_for_passport(obj, type) //type - нахождение вагона в сушиле или в печи (1-сушило, 2-печь)
{
    if (!window.XMLHttpRequest)
        request = new ActiveXObject("Msxml2.XMLHTTP");
    else
        request = new XMLHttpRequest();
    switch (type) {
        case ('dry'):
            type2 = 1;
            break;
        case ('furn'):
            type2 = 2;
            break;
        default:
            type2 = 0;
            break;
    }

    if (request != null) {
        request.onreadystatechange = processRequestChange_for_passport;
        request.open("POST", "/ASUTP/php/cshi_tunnel/sqlrequest.php?CartPos=" + obj.value + "&Type=" + type2, false);
        request.send(null);
    } else
        alert('ошибка при создании xmlrequest!');
}

var passport_arr_name = [];
var passport_arr_value = [];

function UpdateElements_for_passport(ServerAnswer) {
    var arr = [];
    var Elements = [];
    var text_result;
    Elements = ServerAnswer.split(";");
//	var TT = 123.251235412;
//	alert(TT.toFixed(2));

    for (var i = 0; i < Elements.length; i++) {
        passport_arr_name[i] = GetElementName(Elements[i]);
        if (GetElementValue(Elements[i]) == null || GetElementValue(Elements[i]) == '1970-01-01 05:00:00')
            passport_arr_value[i] = "-";
        else
            passport_arr_value[i] = arr[i] = GetElementValue(Elements[i]);
    }
    switch (type2) {
        case (1):
            text_result = "<table id='passport_table' cellpadding='0' cellspacing='0' id='Table1' style='position:absolute;left:0px;top:10px;width:606px;height:992px;z-index:0;border:1px #C0C0C0 solid;'><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px; color:blue;'><b>ПАСПОРТ ВАГОНА №" + passport_arr_value[4] + "</b></td></tr><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px;'><b>Данные по сушилу:</b></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Технолог оператор</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[37] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Бригада №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px; '><center>&nbsp;" + passport_arr_value[31] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Смена №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[33] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в сушило</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[0] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в сушило (реальное)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[45] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон вышел из сушила</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[1] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество вагонов в сушиле на момент загрузки</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[39] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество вагонов в сушиле на момент выгрузки</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[40] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 3 (левая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[17], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 3 (правая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[47], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 10 (левая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[18], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 10 (правая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[48], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура подаваемого воздуха в сушило</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[19], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Расход горячего воздуха в сушило</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[11], 2, ".") + "&nbsp;*10<sup>3</sup> м<sup>3</sup>/ч</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Разрежение в сушиле на позиции 3</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[43], 2, ".") + "&nbsp;кПа</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Давление в сушиле на позиции 10</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[44], 2, ".") + "&nbsp;кПа</center></td></tr><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px;'><b>Данные по печи</b></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Технолог оператор</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[36] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Бригада №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[30] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Смена №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[32] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в печь</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[2] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в печь (реальное)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[46] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Время выхода вагона из печи</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[3] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура под сводом печи на позиции 15</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[20], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура под сводом печи на позиции 20</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[21], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура под сводом печи на позиции 23</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[22], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура отходящих газов на позиции 30-34</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[23], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Средний расход газа в печь</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[10], 2, ".") + "&nbsp;*10<sup>2</sup> м<sup>3</sup>/ч</td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Расход воздуха распределенной подачи</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[12], 2, ".") + "&nbsp;*10<sup>3</sup> м<sup>3</sup>/ч</td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Средний расход воздуха на горение</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[13], 2, ".") + "&nbsp;*10<sup>3</sup> м<sup>3</sup>/ч</td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Среднее давление газа в печь</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[14], 2, ".") + "&nbsp;кгс/м<sup>2</sup></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Давление на позиции 28</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[15], 2, ".") + "&nbsp;кгс/м<sup>2</sup></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Разрежение на позиции 10</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[16], 2, ".") + "&nbsp;кгс/м<sup>2</sup></td></tr><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px;'><b>Общие данные</b></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество прогонок</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[40] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Повторный обжиг</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[24] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Кажущаяся плотность сырца</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[7] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Тип вагона</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[25] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вид сырья</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[8] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Марка кирпича</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[5] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество ёлок</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[26] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество брикетов</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[27] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>На подсаде</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[28] + "</center></td></tr></table>";
            break;
        case (2):
            text_result = "<table id='passport_table' cellpadding='0' cellspacing='0' id='Table1' style='position:absolute;left:0px;top:10px;width:606px;height:992px;z-index:0;border:1px #C0C0C0 solid;'><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px; color:blue;'><b>ПАСПОРТ ВАГОНА №" + passport_arr_value[4] + "</b></td></tr><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px;'><b>Данные по печи:</b></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Технолог оператор</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[37] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Бригада №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px; '><center>&nbsp;" + passport_arr_value[31] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Смена №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[33] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в сушило</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[0] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в сушило (реальное)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[45] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон вышел из сушила</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[1] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество вагонов в сушиле на момент загрузки</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[39] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество вагонов в сушиле на момент выгрузки</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[40] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 3 (левая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[17], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 3 (правая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[47], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 10 (левая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[18], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 10 (правая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[48], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура подаваемого воздуха в сушило</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[19], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Расход горячего воздуха в сушило</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[11], 2, ".") + "&nbsp;*10<sup>3</sup> м<sup>3</sup>/ч</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Разрежение в сушиле на позиции 3</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[43], 2, ".") + "&nbsp;кПа</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Давление в сушиле на позиции 10</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[44], 2, ".") + "&nbsp;кПа</center></td></tr><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px;'><b>Данные по печи</b></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Технолог оператор</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[36] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Бригада №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[30] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Смена №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[32] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в печь</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[2] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в печь (реальное)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[46] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Время выхода вагона из печи</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[3] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура под сводом печи на позиции 15</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[20], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура под сводом печи на позиции 20</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[21], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура под сводом печи на позиции 23</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[22], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура отходящих газов на позиции 30-34</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[23], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Средний расход газа в печь</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[10], 2, ".") + "&nbsp;*10<sup>2</sup> м<sup>3</sup>/ч</td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Расход воздуха распределенной подачи</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[12], 2, ".") + "&nbsp;*10<sup>3</sup> м<sup>3</sup>/ч</td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Средний расход воздуха на горение</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[13], 2, ".") + "&nbsp;*10<sup>3</sup> м<sup>3</sup>/ч</td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Среднее давление газа в печь</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[14], 2, ".") + "&nbsp;кгс/м<sup>2</sup></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Давление на позиции 28</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[15], 2, ".") + "&nbsp;кгс/м<sup>2</sup></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Разрежение на позиции 10</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[16], 2, ".") + "&nbsp;кгс/м<sup>2</sup></td></tr><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px;'><b>Общие данные</b></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество прогонок</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[40] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Повторный обжиг</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[24] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Кажущаяся плотность сырца</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[7] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Тип вагона</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[25] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вид сырья</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[8] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Марка кирпича</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[5] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество ёлок</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[26] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество брикетов</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[27] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>На подсаде</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[28] + "</center></td></tr></table>";
            break;
        default:
            text_result = "<table id='passport_table' cellpadding='0' cellspacing='0' id='Table1' style='position:absolute;left:0px;top:10px;width:606px;height:992px;z-index:0;border:1px #C0C0C0 solid;'><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px; color:blue;'><b>ПАСПОРТ ВАГОНА №" + passport_arr_value[4] + "</b></td></tr><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px;'><b>Данные по печи:</b></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Технолог оператор</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[37] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Бригада №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px; '><center>&nbsp;" + passport_arr_value[31] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Смена №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[33] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в сушило</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[0] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в сушило (реальное)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[45] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон вышел из сушила</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[1] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество вагонов в сушиле на момент загрузки</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[39] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество вагонов в сушиле на момент выгрузки</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[40] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 3 (левая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[17], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 3 (правая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[47], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 10 (левая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[18], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура воздуха в сушиле на позиции 10 (правая сторона)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[48], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура подаваемого воздуха в сушило</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[19], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Расход горячего воздуха в сушило</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[11], 2, ".") + "&nbsp;*10<sup>3</sup> м<sup>3</sup>/ч</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Разрежение в сушиле на позиции 3</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[43], 2, ".") + "&nbsp;кПа</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Давление в сушиле на позиции 10</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[44], 2, ".") + "&nbsp;кПа</center></td></tr><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px;'><b>Данные по печи</b></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Технолог оператор</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[36] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Бригада №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[30] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Смена №</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[32] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в печь</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[2] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вагон поставили в печь (реальное)</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[46] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Время выхода вагона из печи</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[3] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура под сводом печи на позиции 15</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[20], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура под сводом печи на позиции 20</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[21], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура под сводом печи на позиции 23</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[22], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Температура отходящих газов на позиции 30-34</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[23], 2, ".") + "&nbsp;<sup>o</sup>С</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Средний расход газа в печь</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[10], 2, ".") + "&nbsp;*10<sup>2</sup> м<sup>3</sup>/ч</td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Расход воздуха распределенной подачи</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[12], 2, ".") + "&nbsp;*10<sup>3</sup> м<sup>3</sup>/ч</td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Средний расход воздуха на горение</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[13], 2, ".") + "&nbsp;*10<sup>3</sup> м<sup>3</sup>/ч</td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Среднее давление газа в печь</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[14], 2, ".") + "&nbsp;кгс/м<sup>2</sup></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Давление на позиции 28</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[15], 2, ".") + "&nbsp;кгс/м<sup>2</sup></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Разрежение на позиции 10</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + sdf_FTS(passport_arr_value[16], 2, ".") + "&nbsp;кгс/м<sup>2</sup></td></tr><tr><td align='center' valign='top' colspan='2' style='border:1px #C0C0C0 solid;height:20px;'><b>Общие данные</b></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество прогонок</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[40] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Повторный обжиг</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[24] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Кажущаяся плотность сырца</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[7] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Тип вагона</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[25] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Вид сырья</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[8] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Марка кирпича</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[5] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество ёлок</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[26] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>Количество брикетов</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[27] + "</center></td></tr><tr><td align='left' valign='top' style='border:1px #C0C0C0 solid;width:470px;height:20px;'>На подсаде</td><td align='left' valign='top' style='border:1px #C0C0C0 solid;height:20px;'><center>&nbsp;" + passport_arr_value[28] + "</center></td></tr></table>";
            break;
    }
    $('#dialog').html(text_result);
}

function processRequestChange_for_passport() {
    if (request.readyState == 4) {
//     alert('ответ:'+request.responseText);
        UpdateElements_for_passport(request.responseText)
    }
}

//------------------------------------------------------------------------------
function GetElementName(Element) {
    var EqualityPosition = Element.indexOf("=");
    ElementName = Element.slice(0, EqualityPosition);
    return ElementName;
}

//------------------------------------------------------------------------------
function GetElementValue(Element) {
    var EqualityPosition = Element.indexOf("=");
    ElementValue = Element.slice(EqualityPosition + 1, Element.length);
    return ElementValue;
}

//------------------------------------------------------------------------------